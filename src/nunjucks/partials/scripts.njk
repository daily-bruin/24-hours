<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.12.0.min.js"><\/script>')</script>
<script src="js/bundle.js"></script>
{# <script src="https://cdnjs.cloudflare.com/ajax/libs/scrollify/1.0.19/jquery.scrollify.js"></script> #}
<script src="https://cdnjs.cloudflare.com/ajax/libs/fullPage.js/2.9.6/jquery.fullpage.js"></script>
<script src="https://cdn.jsdelivr.net/npm/countup@1.8.2/countUp.js"></script>
<script>
    {# $(function() {
        $.scrollify({
        section : ".photo-container",
        });
    }); #}

    // DOM VARIABLES
    let overlay = document.getElementById('shadow-overlay');
    let caption = document.getElementById('caption');
    let indicator = document.getElementById('indicator');
    let time = document.getElementById('time');
    let captionReadMore = document.getElementById('caption-read-more');
    let captionWrapper = document.getElementById('time-caption-wrapper');
    let oldTopWrapper = captionWrapper.style.getPropertyValue('top');
    //FOR COUNTUPJS
    var options = {
      useEasing: true, 
      useGrouping: true, 
      separator: ',', 
      decimal: ':',
    };
    var demo = new CountUp('time', 0, 1.23, 2, 2.5, options);
    if (!demo.error) {
      demo.start();
    } else {
      console.error(demo.error);
    }

    // Event listeners
    // check for read more function
    captionReadMore.addEventListener('click', readMore);
    // hide caption
    overlay.addEventListener('click', readLess);
    time.addEventListener('click', readMore);
    function readMore() {
       overlay.style.opacity = 0.65;
       overlay.style.zIndex = 3;
       caption.style.opacity = 1;
       captionReadMore.style.height = 0;
       captionReadMore.style.opacity = 0;
       captionWrapper.style.top = '50%';
    }

    function readLess() {
        overlay.style.opacity = 0;
        overlay.style.zIndex = -1;
        caption.style.opacity = 0;
        captionReadMore.style.height = '1rem';
        captionReadMore.style.opacity = 1;
        captionWrapper.style.top = oldTopWrapper;
    }

    //FOR FULLPAGE.JS
    //$(document).ready(function() {
        $('#fullpage').fullpage({
            sectionSelector: '.photo-container',
            menu: '#sidebar-links',
            lazyload: true,
            autoScrolling: true,
            // callback function that updates the clock and caption
            afterLoad: function(anchorLink, index) {
                // update clock
                let updateSlide = document.getElementById(index + 'id');
                console.log(updateSlide);
                let newTime = updateSlide.getAttribute('data-time');
                demo.update(newTime);
                //update caption
                let newCaption = updateSlide.getAttribute('data-caption');
                caption.innerHTML = newCaption + '<br>' + updateSlide.getAttribute('data-credit');;
                //indicator.innerHTML = updateSlide.getAttribute('data-indicator');
                demo.options.suffix = updateSlide.getAttribute('data-indicator');
            }
        });
    //});
</script>
